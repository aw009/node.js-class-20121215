{"ts":1355612775618,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"//These are node modules. They allow you to use node.js's APIs\r\nvar http = require('http'),\r\n    url = require('url');\r\n\r\n//This variable attaches to the global object, so it is available in several sessions.\r\nvar userCount = 0;\r\n\r\n//create the server by calling the createServer method on http, which returns a new httpServer.\r\nhttp.createServer(function (request,response) {\r\n\t//line 14 is the same as the following three lines :\r\n\t//var rawPath = request.url\r\n\t//var theURL = url.parse(rawPath)\r\n\t//var path = theURL.pathname;\r\n\tvar path = url.parse(request.url).pathname;\r\n\r\n\tgetBody(path, function(err, body) {\r\n        if (err) {\r\n            response.writeHead(500, {\r\n            'Content-Length': err.length,\r\n            'Content-Type': 'text/html' })\r\n            response.end(err);\r\n            return;\r\n        }\r\n        console.log(body);\r\n        response.writeHead(200, {\r\n        'Content-Length': body.length,\r\n        'Content-Type': 'text/html' })\r\n        response.end(body);\r\n\t});\r\n\r\n//Here we use process.env.PORT to access the port given to this process. This is an environment variable available to you that will give you the port that your\r\n//server is being hosted on.\r\n}).listen(process.env.PORT);\r\n\r\n//Here we have a function with standard node.js convention - err and \"result\".\r\n//Err returns as undefined if there is no error, which is what is expected.\r\n//we don't want it to throw any exceptions - if we did, we'd need to be very explicit in the documentation about that.\r\nfunction getBody(path, callback) {\r\n\tuserCount++;\r\n    var body;\r\n\tif (path === '/basic') {\r\n\t\tbody = 'usercount : ' + userCount;\r\n\t} else if (path === '/advanced') {\r\n\t\tbody = '<!doctype html><html><head><title>Advanced Page</title></head><body>Hello! The user count is now : ' + userCount + '</body></html>';\r\n\t\treturn;\r\n\t} else if (path === '/favicon.ico') {\r\n\t\tuserCount--;\r\n\t\tbody = 'x';\r\n\t} else {\r\n\t\tvar err = 'You didn\\'t specify a path!';\r\n\t}\r\n    callback(err, body);\r\n}"]],"start1":0,"start2":0,"length1":0,"length2":1987}]],"length":1987}
{"contributors":[],"silentsave":false,"ts":1355618011058,"patch":[[{"diffs":[[0,": 'text/html' })"],[1,";"],[0,"\r\n            re"]],"start1":745,"start2":745,"length1":32,"length2":33},{"diffs":[[0,"html' })"],[1,";"],[0,"\r\n      "]],"start1":961,"start2":961,"length1":16,"length2":17}]],"length":1989,"saved":false}
